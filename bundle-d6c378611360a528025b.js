(()=>{"use strict";var e={193:(e,t,i)=>{i.r(t)},216:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.resetCounter=t.initCounter=t.fifteenCounter=t.generateGame=void 0;const n=i(171);t.generateGame=({field:e,gridContainer:t,tileContainer:i,matrix:n})=>{r(n,t),e.map((e=>o(i,String(e))))};const r=(e,t)=>e.map((e=>((e,t)=>{const i=document.createElement("div");return i.className="grid__row",t.appendChild(i),e.map((()=>(e=>{const t=document.createElement("div");return t.className="grid__cell",e.appendChild(t)})(i)))})(e,t))),o=(e,t)=>{const i=document.createElement("div");i.className="tile",i.dataset.matrixId=t,i.innerText=t,"0"===t&&(i.style.opacity="0"),e.appendChild(i)};t.fifteenCounter=document.querySelector("#fifteenCounter"),t.initCounter=()=>(console.log(123),(0,n.counterStorage)()?t.fifteenCounter.innerHTML=(0,n.counterStorage)():(0,n.updateLocalCounter)(0)),t.resetCounter=()=>{t.fifteenCounter.innerHTML="0",(0,n.updateLocalCounter)(0)}},321:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.incrementCounter=t.shuffleField=t.checkWin=t.firstZeroConcat=t.isValidForSwap=t.findCoordByNumber=t.getMatrix=void 0;const n=i(216),r=i(171);t.getMatrix=(e,t)=>{const i=[];return e.map((()=>i.push(e.splice(0,t)))),i},t.findCoordByNumber=(e,t)=>{for(let i=0;i<t.length;i++)for(let n=0;n<t.length;n++)if(t[i][n]===e)return{x:n,y:i}},t.isValidForSwap=(e,t)=>{const i=Math.abs(e.x-t.x),n=Math.abs(e.y-t.y);return 1!==i&&1!==n||e.x!==t.x&&e.y!==t.y?(0===i&&0!==n||0!==i&&0===n)&&"long-swap":"short-swap"},t.firstZeroConcat=(e,t,i)=>[].concat(t,e.slice(0,i)),t.checkWin=(e,t)=>{JSON.stringify(e)===JSON.stringify(t)&&alert("победа")},t.shuffleField=e=>[...e].sort((()=>Math.random()-.5)).concat(0),t.incrementCounter=()=>{let e=Number(n.fifteenCounter.innerHTML);n.fifteenCounter.innerHTML=String(++e),(0,r.updateLocalCounter)(e)}},689:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.handleKey=t.handleClick=void 0;const n=i(527),r=i(603),o=i(321),a=i(612),l=i(171);t.handleClick=e=>{const t=e.target.closest(".tile"),i=Array.from(document.querySelectorAll(".tile"));if(!t)return;const s=Number(t.dataset.matrixId),f=(0,o.findCoordByNumber)(s,n.fifteen.matrix),c=(0,o.findCoordByNumber)(n.fifteen.blankTile,n.fifteen.matrix),d=(0,o.isValidForSwap)(f,c);d&&("short-swap"===d&&((0,a.swap)(c,f,n.fifteen.matrix),(0,r.setPositionItems)(n.fifteen.matrix,i)),"long-swap"===d&&((0,a.longSwap)(c,f,n.fifteen.matrix),(0,r.setPositionItems)(n.fifteen.matrix,i)),(0,o.incrementCounter)(),(0,l.updateLocalStorage)(n.fifteen))},t.handleKey=e=>{if(!e.key.includes("Arrow"))return;const t=(0,o.findCoordByNumber)(n.fifteen.blankTile,n.fifteen.matrix),i={x:t.x,y:t.y},l=Array.from(document.querySelectorAll(".tile")),s=e.key.split("Arrow")[1].toLowerCase(),f=n.fifteen.matrix.length;switch(s){case"up":i.y+=1;break;case"down":i.y-=1;break;case"left":i.x+=1;break;case"right":i.x-=1}i.y>=f||i.y<0||i.x>=f||i.x<0||((0,a.swap)(t,i,n.fifteen.matrix),(0,r.setPositionItems)(n.fifteen.matrix,l))}},171:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.updateLocalCounter=t.updateLocalStorage=t.counterStorage=t.fifteenStorage=t.matrixStorage=t.sizeStorage=void 0,t.sizeStorage=localStorage.getItem("size"),t.matrixStorage=localStorage.getItem("matrix"),t.fifteenStorage=localStorage.getItem("fifteen"),t.counterStorage=()=>JSON.parse(localStorage.getItem("counter")),t.updateLocalStorage=e=>localStorage.setItem("fifteen",JSON.stringify(e)),t.updateLocalCounter=e=>localStorage.setItem("counter",JSON.stringify(e))},603:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setPositionItems=void 0;const n=i(321),r=i(527);t.setPositionItems=(e,t)=>{for(let i=0;i<e.length;i++)for(let n=0;n<e.length;n++){const r=e[i][n],a=t.find((e=>e.dataset.matrixId===String(r)));if(void 0===a)return;o(a,n+1,i+1)}a(e,r.fifteen.winMatrix).forEach((e=>l(e))),setTimeout((()=>(0,n.checkWin)(e,r.fifteen.winMatrix)),500)};const o=(e,t,i)=>{const n=`tile-position-${t}-${i}`;e.className=`tile ${n}`},a=(e,t)=>{const i=[...e].flat(),n=[...t].flat(),r=[];for(let e=0;e<i.length;e++)i[e]===n[e]&&r.push(n[e]);return r},l=e=>{document.querySelectorAll(".tile").forEach((t=>{Number(t.dataset.matrixId)===e&&t.classList.add("tile_correct")}))}},612:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.longSwap=t.swap=void 0;const n=i(527),r=i(321);t.swap=(e,t,i)=>{const n=i[e.y][e.x];i[e.y][e.x]=i[t.y][t.x],i[t.y][t.x]=n};const o=(e,t,i,o)=>{const a=e.slice(o.x),l=e.length-1;if(0===t&&i===l){const t=e.slice(0,n.fifteen.size);return(0,r.firstZeroConcat)(t,a,l)}if(0===t&&i!==l){const t=e.slice(0,i);t.unshift(0);const r=e.slice(i+1,n.fifteen.size);return[].concat(t,r)}{const i=e.slice(0,t),r=e.slice(t,n.fifteen.size).filter((e=>0!==e));return r.unshift(0),[].concat(i,r)}},a=(e,t,i)=>{const r=e.length-1;if(t===r&&0===i){const t=e.filter((e=>0!==e));return t.push(0),t}if(0!==i&&t===r){const t=e.slice(0,i),r=e.slice(i+1,n.fifteen.size);return r.push(0),[].concat(t,r)}if(0!==i&&t!==r){const i=e.slice(0,t+1).filter((e=>0!==e)),r=e.slice(t+1,n.fifteen.size);return i.push(0),[].concat(i,r)}{const i=e.slice(1,t+1),r=e.slice(t+1,n.fifteen.size);return i.push(0),[].concat(i,r)}},l=(e,t,i)=>{let o=(0,r.findCoordByNumber)(n.fifteen.blankTile,e).y;for(;0!==o;){const a=(0,r.findCoordByNumber)(n.fifteen.blankTile,e),l=e[o][i],s=e[o-1][i];a.y>t.y&&(e[o-1][i]=l,e[o][i]=s),--o}},s=(e,t,i)=>{let o=(0,r.findCoordByNumber)(n.fifteen.blankTile,e).y;for(;o!==t.y;){const t=e[o][i],n=e[o+1][i];e[o+1][i]=t,e[o][i]=n,++o}};t.longSwap=(e,t,i)=>{for(let n=0;n<i.length;n++)for(let r=0;r<i.length;r++){const f=t.x,c=e.x;if(n===t.y){if(c>f)return i[n]=o(i[n],f,c,e);if(c<f)return i[n]=a(i[n],f,c);r===c&&(e.y>t.y&&l(i,t,r),e.y<=t.y&&s(i,t,r))}}}},178:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.initFifteen=void 0;const n=i(603),r=i(689),o=i(216);t.initFifteen=(e,t)=>{const i=document.querySelector(".tiles"),a=document.querySelector(".grid");i.removeEventListener("click",r.handleClick),window.removeEventListener("keydown",r.handleKey),i.innerHTML="",a.innerHTML="",(0,o.generateGame)({field:e,gridContainer:a,tileContainer:i,matrix:t});const l=Array.from(i.querySelectorAll(".tile"));(0,n.setPositionItems)(t,l),i.addEventListener("click",r.handleClick),window.addEventListener("keydown",r.handleKey),(0,o.initCounter)()}},527:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.fifteen=t.selector=void 0;const n=i(171),r=i(321),o=i(178),a=i(216);let l=Number(window.location.search.slice(-1));t.selector=document.querySelector(".game__select");const s=Number(t.selector.options[t.selector.selectedIndex].value),f=document.querySelector("#newGameFifteen");window.addEventListener("load",(()=>{if(n.fifteenStorage){const e=JSON.parse(n.fifteenStorage);l=l>7?l=7:l<3||isNaN(l)?l=3:l,l!==e.size&&confirm("Вы уверенны? Текущий процесс будет потерян")&&((0,a.resetCounter)(),history.pushState(null,"",`/?size=${l}`),p(l),localStorage.setItem("size",JSON.stringify(l)))}})),n.sizeStorage&&Array.from(t.selector.options).forEach((e=>{Number(e.value)===JSON.parse(n.sizeStorage)&&(e.selected=!0,history.pushState(null,"",`/?size=${e.value}`))})),n.sizeStorage||localStorage.setItem("size",JSON.stringify(s));const c=n.sizeStorage?Number(n.sizeStorage):Number(t.selector.options[t.selector.selectedIndex].value),d=Math.pow(c,2),u=[...Array(d-1).keys()].map((e=>++e)),m=(0,r.shuffleField)(u),g=n.matrixStorage?JSON.parse(n.matrixStorage):(0,r.getMatrix)([...m],c),y=(0,r.getMatrix)([...u.concat(0)],c);function p(e){t.fifteen.size=e,t.fifteen.fieldSize=Math.pow(t.fifteen.size,2),t.fifteen.initialField=[...Array(t.fifteen.fieldSize-1).keys()].map((e=>++e)),t.fifteen.field=(0,r.shuffleField)(t.fifteen.initialField),t.fifteen.matrix=(0,r.getMatrix)([...t.fifteen.field],t.fifteen.size),t.fifteen.winMatrix=(0,r.getMatrix)([...t.fifteen.initialField.concat(0)],t.fifteen.size),(0,n.updateLocalStorage)(t.fifteen),(0,o.initFifteen)(t.fifteen.field,t.fifteen.matrix)}t.fifteen={size:c,fieldSize:d,initialField:u,field:m,matrix:g,winMatrix:y,blankTile:0},localStorage.getItem("fifteen")&&(t.fifteen=JSON.parse(localStorage.getItem("fifteen"))),t.selector.addEventListener("change",(e=>{const t=e.target,i=Number(t.options[t.selectedIndex].value);confirm("Вы уверенны? Текущий процесс будет потерян")&&((0,a.resetCounter)(),localStorage.setItem("size",JSON.stringify(i)),p(i),history.pushState(null,"",`/?size=${i}`))})),f.addEventListener("click",(function(e){e.preventDefault(),confirm("Вы уверенны? Текущий процесс будет потерян")&&((0,a.resetCounter)(),p(l))}))}},t={};function i(n){var r=t[n];if(void 0!==r)return r.exports;var o=t[n]={exports:{}};return e[n](o,o.exports,i),o.exports}i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{i(193);const e=i(178),t=i(527);(0,e.initFifteen)(t.fifteen.field,t.fifteen.matrix)})()})();