(()=>{"use strict";var e={193:(e,t,i)=>{i.r(t)},216:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.generateGame=void 0;t.generateGame=({field:e,gridContainer:t,tileContainer:r,matrix:o})=>{i(o,t),e.map((e=>n(r,String(e))))};const i=(e,t)=>e.map((e=>((e,t)=>{const i=document.createElement("div");return i.className="grid__row",t.appendChild(i),e.map((()=>(e=>{const t=document.createElement("div");return t.className="grid__cell",e.appendChild(t)})(i)))})(e,t))),n=(e,t)=>{const i=document.createElement("div");i.className="tile",i.dataset.matrixId=t,i.innerText=t,"0"===t&&(i.style.opacity="0"),e.appendChild(i)}},321:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.checkWin=t.firstZeroConcat=t.isValidForSwap=t.findCoordByNumber=t.getMatrix=void 0,t.getMatrix=(e,t)=>{const i=[];return e.map((()=>i.push(e.splice(0,t)))),i},t.findCoordByNumber=(e,t)=>{for(let i=0;i<t.length;i++)for(let n=0;n<t.length;n++)if(t[i][n]===e)return{x:n,y:i}},t.isValidForSwap=(e,t)=>{const i=Math.abs(e.x-t.x),n=Math.abs(e.y-t.y);return 1!==i&&1!==n||e.x!==t.x&&e.y!==t.y?(0===i&&0!==n||0!==i&&0===n)&&"long-swap":"short-swap"},t.firstZeroConcat=(e,t,i)=>[].concat(t,e.slice(0,i)),t.checkWin=(e,t)=>{JSON.stringify(e)===JSON.stringify(t)&&console.log("победа")}},689:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.handleKey=t.handleClick=void 0;const n=i(527),r=i(603),o=i(321),a=i(612),s=i(171);t.handleClick=e=>{const t=e.target.closest(".tile"),i=Array.from(document.querySelectorAll(".tile"));if(!t)return;const l=Number(t.dataset.matrixId),f=(0,o.findCoordByNumber)(l,n.fifteen.matrix),c=(0,o.findCoordByNumber)(n.fifteen.blankTile,n.fifteen.matrix),d=(0,o.isValidForSwap)(f,c);console.log(d),d&&("short-swap"===d&&((0,a.swap)(c,f,n.fifteen.matrix),(0,r.setPositionItems)(n.fifteen.matrix,i)),"long-swap"===d&&((0,a.longSwap)(c,f,n.fifteen.matrix),(0,r.setPositionItems)(n.fifteen.matrix,i)),(0,s.updateLocalStorage)(n.fifteen))},t.handleKey=e=>{if(!e.key.includes("Arrow"))return;const t=(0,o.findCoordByNumber)(n.fifteen.blankTile,n.fifteen.matrix),i={x:t.x,y:t.y},s=Array.from(document.querySelectorAll(".tile")),l=e.key.split("Arrow")[1].toLowerCase(),f=n.fifteen.matrix.length;switch(l){case"up":i.y+=1;break;case"down":i.y-=1;break;case"left":i.x+=1;break;case"right":i.x-=1}i.y>=f||i.y<0||i.x>=f||i.x<0||((0,a.swap)(t,i,n.fifteen.matrix),(0,r.setPositionItems)(n.fifteen.matrix,s))}},171:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.updateLocalStorage=t.matrixStorage=t.sizeStorage=void 0,t.sizeStorage=localStorage.getItem("size"),t.matrixStorage=localStorage.getItem("matrix"),t.updateLocalStorage=e=>localStorage.setItem("fifteen",JSON.stringify(e))},603:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setPositionItems=void 0;const n=i(321),r=i(527);t.setPositionItems=(e,t)=>{for(let i=0;i<e.length;i++)for(let n=0;n<e.length;n++){const r=e[i][n],a=t.find((e=>e.dataset.matrixId===String(r)));if(void 0===a)return;o(a,n+1,i+1)}a(e,r.fifteen.winMatrix).forEach((e=>s(e))),setTimeout((()=>(0,n.checkWin)(e,r.fifteen.winMatrix)),500)};const o=(e,t,i)=>{const n=`tile-position-${t}-${i}`;e.className=`tile ${n}`},a=(e,t)=>{const i=[...e].flat(),n=[...t].flat(),r=[];for(let e=0;e<i.length;e++)i[e]===n[e]&&r.push(n[e]);return r},s=e=>{document.querySelectorAll(".tile").forEach((t=>{Number(t.dataset.matrixId)===e&&t.classList.add("tile_correct")}))}},612:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.longSwap=t.swap=void 0;const n=i(527),r=i(321);t.swap=(e,t,i)=>{const n=i[e.y][e.x];i[e.y][e.x]=i[t.y][t.x],i[t.y][t.x]=n};const o=(e,t,i,o)=>{const a=e.slice(o.x),s=e.length-1;if(0===t&&i===s){const t=e.slice(0,n.fifteen.size);return(0,r.firstZeroConcat)(t,a,s)}if(0===t&&i!==s){const t=e.slice(0,i);t.unshift(0);const r=e.slice(i+1,n.fifteen.size);return[].concat(t,r)}{const i=e.slice(0,t),r=e.slice(t,n.fifteen.size).filter((e=>0!==e));return r.unshift(0),[].concat(i,r)}},a=(e,t,i)=>{const r=e.length-1;if(t===r&&0===i){const t=e.filter((e=>0!==e));return t.push(0),t}if(0!==i&&t===r){const t=e.slice(0,i),r=e.slice(i+1,n.fifteen.size);return r.push(0),[].concat(t,r)}if(0!==i&&t!==r){const i=e.slice(0,t+1).filter((e=>0!==e)),r=e.slice(t+1,n.fifteen.size);return i.push(0),[].concat(i,r)}{const i=e.slice(1,t+1),r=e.slice(t+1,n.fifteen.size);return i.push(0),[].concat(i,r)}},s=(e,t,i)=>{let o=(0,r.findCoordByNumber)(n.fifteen.blankTile,e).y;for(;0!==o;){const a=(0,r.findCoordByNumber)(n.fifteen.blankTile,e),s=e[o][i],l=e[o-1][i];a.y>t.y&&(e[o-1][i]=s,e[o][i]=l),--o}},l=(e,t,i)=>{let o=(0,r.findCoordByNumber)(n.fifteen.blankTile,e).y;for(;o!==t.y;){const t=e[o][i],n=e[o+1][i];e[o+1][i]=t,e[o][i]=n,++o}};t.longSwap=(e,t,i)=>{for(let n=0;n<i.length;n++)for(let r=0;r<i.length;r++){const f=t.x,c=e.x;if(n===t.y){if(c>f)return i[n]=o(i[n],f,c,e);if(c<f)return i[n]=a(i[n],f,c);r===c&&(e.y>t.y&&s(i,t,r),e.y<=t.y&&l(i,t,r))}}}},178:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.initFifteen=void 0;const n=i(603),r=i(689),o=i(216);t.initFifteen=(e,t)=>{const i=document.querySelector(".tiles"),a=document.querySelector(".grid");i.removeEventListener("click",r.handleClick),window.removeEventListener("keydown",r.handleKey),i.innerHTML="",a.innerHTML="",(0,o.generateGame)({field:e,gridContainer:a,tileContainer:i,matrix:t});const s=Array.from(i.querySelectorAll(".tile"));(0,n.setPositionItems)(t,s),i.addEventListener("click",r.handleClick),window.addEventListener("keydown",r.handleKey)}},527:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.fifteen=t.selector=void 0;const n=i(171),r=i(321),o=i(178);t.selector=document.querySelector(".game__select");const a=Number(t.selector.options[t.selector.selectedIndex].value);n.sizeStorage&&Array.from(t.selector.options).forEach((e=>{e.value===n.sizeStorage&&(e.selected=!0)})),n.sizeStorage||localStorage.setItem("size",JSON.stringify(a));const s=n.sizeStorage?Number(n.sizeStorage):Number(t.selector.options[t.selector.selectedIndex].value),l=Math.pow(s,2),f=[...Array(l-1).keys()].map((e=>++e)),c=[...f].sort((()=>Math.random()-.5)).concat(0),d=n.matrixStorage?JSON.parse(n.matrixStorage):(0,r.getMatrix)([...c],s),u=(0,r.getMatrix)([...f.concat(0)],s);t.fifteen={size:s,fieldSize:l,initialField:f,field:c,matrix:d,winMatrix:u,blankTile:0},localStorage.getItem("fifteen")&&(t.fifteen=JSON.parse(localStorage.getItem("fifteen"))),t.selector.addEventListener("change",(e=>{const i=e.target,a=Number(i.options[i.selectedIndex].value);localStorage.setItem("size",JSON.stringify(a)),t.fifteen.size=a,t.fifteen.fieldSize=Math.pow(t.fifteen.size,2),t.fifteen.initialField=[...Array(t.fifteen.fieldSize-1).keys()].map((e=>++e)),t.fifteen.field=[...t.fifteen.initialField].sort((()=>Math.random()-.5)).concat(0),t.fifteen.matrix=(0,r.getMatrix)([...t.fifteen.field],t.fifteen.size),t.fifteen.winMatrix=(0,r.getMatrix)([...t.fifteen.initialField.concat(0)],t.fifteen.size),(0,n.updateLocalStorage)(t.fifteen),(0,o.initFifteen)(t.fifteen.field,t.fifteen.matrix)}))}},t={};function i(n){var r=t[n];if(void 0!==r)return r.exports;var o=t[n]={exports:{}};return e[n](o,o.exports,i),o.exports}i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{i(193);const e=i(178),t=i(527);(0,e.initFifteen)(t.fifteen.field,t.fifteen.matrix)})()})();